

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Basic workflow &mdash; Experiment Notebook MIT License documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Image compression" href="image_compression.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Experiment Notebook
          

          
            
            <img src="_static/enb_logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="contents.html">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-curation"><strong>1 - Data curation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#result-column-definition"><strong>2 - Result column definition</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-reporting"><strong>3 - Data reporting</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#it-s-good-to-know"><strong>It’s good to know…</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="image_compression.html">Image compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzing_data.html">Analyzing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_options.html">Command-line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="thanks.html">Thanks</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Experiment Notebook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="contents.html">Contents</a> &raquo;</li>
        
      <li>Basic workflow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/basic_workflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-workflow">
<h1>Basic workflow<a class="headerlink" href="#basic-workflow" title="Permalink to this headline">¶</a></h1>
<p>This page explains the basic workflow with <code class="docutils literal notranslate"><span class="pre">enb</span></code> with a <a class="reference external" href="./_static/example_basic_workflow.zip">simple example</a>.
You can find the lastest version of this example at the
<a class="reference external" href="https://github.com/miguelinux314/experiment-notebook/tree/master/templates/basic_workflow_example">templates/basic_workflow</a>
folder of the project.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/general_structure.png"><img alt="Basic steps when using ``enb``" src="_images/general_structure.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Basic steps when using <code class="docutils literal notranslate"><span class="pre">enb</span></code>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The basic workflow when using <code class="docutils literal notranslate"><span class="pre">enb</span></code> can be summarized in three key steps:</p>
<div class="section" id="data-curation">
<h2><strong>1 - Data curation</strong><a class="headerlink" href="#data-curation" title="Permalink to this headline">¶</a></h2>
<p>The first step is to gather and curate your data samples.
It should be possible to obtain individual results for each data sample.
For instance, if you work in image processing, each sample could be one
of your test images, if you work with genetic sequences, each file could
be one sequence, etc.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is best practice to separate data samples from
test parameters (e.g., arguments to the algorithm(s) used to process
each of your samples.</p>
</div>
</div></blockquote>
<p>In this basic example, each sample is the source of a Wikipedia article:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="p">:</span>
<span class="n">a_turing</span><span class="o">.</span><span class="n">txt</span>
<span class="n">c_shannon</span><span class="o">.</span><span class="n">txt</span>
<span class="n">d_knuth</span><span class="o">.</span><span class="n">txt</span>
<span class="n">k_popper</span><span class="o">.</span><span class="n">txt</span>
<span class="n">m_curie</span><span class="o">.</span><span class="n">txt</span>
<span class="n">n_chomsky</span><span class="o">.</span><span class="n">txt</span>
<span class="n">r_franklin</span><span class="o">.</span><span class="n">txt</span>
<span class="n">s_beauvoir</span><span class="o">.</span><span class="n">txt</span>
<span class="n">scientific_method</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>One can gather all such input samples with a single line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_paths</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;./data/wiki/*.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="result-column-definition">
<h2><strong>2 - Result column definition</strong><a class="headerlink" href="#result-column-definition" title="Permalink to this headline">¶</a></h2>
<p>The second step consists in defining the function(s) that produce the desired results.
The easiest way is to extend the <a class="reference internal" href="api/enb.html#enb.atable.ATable" title="enb.atable.ATable"><code class="xref py py-class docutils literal notranslate"><span class="pre">enb.atable.ATable</span></code></a> class, like for example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WikiAnalysis</span><span class="p">(</span><span class="n">enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">ATable</span><span class="p">):</span>
 <span class="nd">@enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">column_function</span><span class="p">(</span><span class="s2">&quot;line_count&quot;</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">set_line_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
     <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
         <span class="n">row</span><span class="p">[</span><span class="s2">&quot;line_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">)</span>
</pre></div>
</div>
<p>In general, this can be done in two simple steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Define a method <code class="docutils literal notranslate"><span class="pre">f</span></code> with interface <code class="docutils literal notranslate"><span class="pre">f(self,</span> <span class="pre">file_path,</span> <span class="pre">row)</span></code>. The <code class="docutils literal notranslate"><span class="pre">file_path</span></code>
argument is the path to one test sample (e.g., <code class="docutils literal notranslate"><span class="pre">./data/wiki/s_beauvoir.txt</span></code>.
The <code class="docutils literal notranslate"><span class="pre">row</span></code> argument is a dict-like instance, into which the desired result (for this input sample)
is to be stored.</p></li>
<li><p>Decorate the method with <code class="docutils literal notranslate"><span class="pre">&#64;enb.atable.column_function(column_name)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">column_name</span></code> is a unique name that identifies the result produced by the method.</p></li>
</ul>
</div></blockquote>
<p>Once data are available and our <a class="reference internal" href="api/enb.html#enb.atable.ATable" title="enb.atable.ATable"><code class="xref py py-class docutils literal notranslate"><span class="pre">enb.atable.ATable</span></code></a> subclass is defined,
a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.0.dev0+221.g25069e069c)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> instance containing results can be obtained as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">WikiAnalysis</span><span class="p">(</span><span class="n">csv_support_path</span><span class="o">=</span><span class="s2">&quot;persistence_basic_workflow.csv&quot;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">get_df</span><span class="p">(</span><span class="n">target_indices</span><span class="o">=</span><span class="n">sample_paths</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">csv_support_path</span></code> argument is the file used to store the <a class="reference external" href="_static/persistence_basic_workflow.csv">raw results</a>.
This avoids re-running the <code class="docutils literal notranslate"><span class="pre">&#64;enb.atable.column_function</span></code>-decorated functions more than once.</p>
</div>
</div>
<div class="section" id="data-reporting">
<h2><strong>3 - Data reporting</strong><a class="headerlink" href="#data-reporting" title="Permalink to this headline">¶</a></h2>
<p>Produced results are made available as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.0.dev0+221.g25069e069c)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> instances.
The <code class="docutils literal notranslate"><span class="pre">enb</span></code> library provides a few automatic tools to analyze and report
one or more data columns. You can find gallery of plotting and analysis tools available in <cite>enb</cite>
in the <a class="reference internal" href="analyzer_gallery.html"><span class="doc">Analyzer gallery</span></a>.</p>
<p>The most basic automatic analyzer is <a class="reference internal" href="api/enb.html#enb.aanalysis.ScalarDistributionAnalyzer" title="enb.aanalysis.ScalarDistributionAnalyzer"><code class="xref py py-class docutils literal notranslate"><span class="pre">enb.aanalysis.ScalarDistributionAnalyzer</span></code></a>.
It produces an histogram of the values of a given data column, and shows average and
standard deviation on top.
In our example, to see the distribution of line counts over the test samples,
the following code can be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scalar_analyzer</span> <span class="o">=</span> <span class="n">enb</span><span class="o">.</span><span class="n">aanalysis</span><span class="o">.</span><span class="n">ScalarDistributionAnalyzer</span><span class="p">()</span>
<span class="n">scalar_analyzer</span><span class="o">.</span><span class="n">analyze_df</span><span class="p">(</span>
  <span class="n">full_df</span><span class="o">=</span><span class="n">result_df</span><span class="p">,</span>
  <span class="n">target_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;line_count&quot;</span><span class="p">],</span>
  <span class="n">output_plot_dir</span><span class="o">=</span><span class="s2">&quot;plots&quot;</span><span class="p">,</span>
  <span class="n">output_csv_file</span><span class="o">=</span><span class="s2">&quot;analysis/line_count_analysis.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can download here <a class="reference external" href="_static/distribution_line_count.pdf">the resulting figure</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">full_df</span></code> is the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.0.dev0+221.g25069e069c)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> instance produced by <a class="reference internal" href="api/enb.html#enb.atable.ATable" title="enb.atable.ATable"><code class="xref py py-class docutils literal notranslate"><span class="pre">enb.atable.ATable</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_csv_file</span></code> generates a CSV file with basic statistics (min, max, average, std) for the target columns.</p></li>
</ul>
</div>
</div>
<div class="section" id="it-s-good-to-know">
<h2><strong>It’s good to know…</strong><a class="headerlink" href="#it-s-good-to-know" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>You can add as many columns as desired (even after running the experiments). Consider the second
method for the <code class="docutils literal notranslate"><span class="pre">WikiAnalysis</span></code> class above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">column_function</span><span class="p">(</span>
    <span class="n">enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">ColumnProperties</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;word_count&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Word count&quot;</span><span class="p">,</span> <span class="n">plot_min</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">set_line_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
        <span class="n">row</span><span class="p">[</span><span class="n">_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">enb.atable.column_function</span></code> decorator accepts <code class="docutils literal notranslate"><span class="pre">enb.atable.ColumnProperties</span></code>
instances. These column properties describe not only the unique name for the data
column, but also other information useful for reporting the obtained results.</p></li>
<li><p>The <cite>_column_name</cite> global is defined whenever a <code class="docutils literal notranslate"><span class="pre">column_function</span></code>-decorated method
is called, containing the unique column name being computed. The use of this global
is totally optional, but enables less error-prone column renaming.</p></li>
</ul>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p>You can analyze the distribution of one column, while grouping based on another. For instance,
if the <code class="docutils literal notranslate"><span class="pre">status</span></code> column is defined in the <code class="docutils literal notranslate"><span class="pre">WikiAnalysis</span></code> class of our example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">column_function</span><span class="p">(</span><span class="n">enb</span><span class="o">.</span><span class="n">atable</span><span class="o">.</span><span class="n">ColumnProperties</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">set_dead_person</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
     <span class="n">row</span><span class="p">[</span><span class="n">_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dead&quot;</span> <span class="k">if</span> <span class="s2">&quot;death_place&quot;</span> <span class="ow">in</span> <span class="n">input_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;alive&quot;</span>
</pre></div>
</div>
<p>then one can make a grouped analysis with the following code snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scalar_analyzer</span><span class="o">.</span><span class="n">analyze_df</span><span class="p">(</span>
        <span class="n">full_df</span><span class="o">=</span><span class="n">result_df</span><span class="p">,</span>
        <span class="n">target_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;word_count&quot;</span><span class="p">],</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;status&quot;</span><span class="p">,</span>
        <span class="n">output_plot_dir</span><span class="o">=</span><span class="s2">&quot;plots&quot;</span><span class="p">,</span>
        <span class="n">output_csv_file</span><span class="o">=</span><span class="s2">&quot;analysis/word_count_analysis.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can download the <a class="reference external" href="_static/distribution_word_count.pdf">resulting plot</a>.</p>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="image_compression.html" class="btn btn-neutral float-right" title="Image compression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Miguel Hernández-Cabronero.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>